<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">
  
  	<kanban columnBy="status" model="com.axelor.gst.db.Invoice" sequenceBy="priority" title="Invoice" name="invoice_kanban">
  		<field name="reference" />
		<field name="invoiceDate" />
		<field name="company" />
		<field name="party" />
		<field name="grossAmount" />
		
		<template>
			<![CDATA[
			<table>
				<tr>
					<strong>{{refrence}}</strong><br/>
				</tr>
				
				<strong>{{invoiceDate}}</strong><br/>
				<strong>Company:{{company.name}}</strong><br/>
				<strong>Party:{{party.name}}</strong><br/>
				<strong>{{grossAmount}}</strong>
			</table>
			]]>
		</template>
  	</kanban>
	
	<grid model="com.axelor.gst.db.Invoice" title="Invoices" name="invoice_grid">
		<field name="refrence" />
		<field name="status" />
		<field name="invoiceDate"/>
		<field name="company" />
		<field name="party" />
		<field name="grossAmount" />
	</grid>
	
	<form model="com.axelor.gst.db.Invoice" title="Invoice" name="invoice_form" onNew="action-on-new-date-time,action-one-new-default-company,action-set-product" 
					onLoad="action-invoice-hide-button" css="panel-blue">
	<toolbar>
		<button onClick="print-invoice" name="print" icon="fa-print" />
	</toolbar>
	<panel name="mainPanel1" title="Invoice">
	
		<field name="status" widget="NavSelect" colSpan="12" showTitle="false" />
		<field name="reference" colSpan="12" />
		<field name="invoiceDate" />
		<field name="company" />
		<field name="party" onChange="action-set-party-contact,action-invoiceAdd-as-shippingAdd" />
		<field name="partyContact" />
		<field name="invoiceAddress" target-name="line1" />
		<field name="useInvoiceAddressAsShippingAddress" onChange="action-invoiceAdd-as-shippingAdd" widget="boolean-switch"/>
		<field name="shippingAddress" target-name="line1" />
	</panel>
	
	<panel name="sidePanel" sidebar="true" title="Status">
		<button onClick="action-invoice-button-click-draft,action-invoice-hide-button" name="draftBtn" title="Draft" hidden="true"/>
		<button onClick="action-click-validate,action-set-invoice-refrence,action-invoice-hide-button" name="validateBtn" title="Validate" />
		<button onClick="action-click-paid,action-invoice-hide-button" name="paidBtn" title="Paid" hidden="true" />
		<button onClick="action-click-Cancelled,action-invoice-hide-button" name="cancelledBtn" title="Cancelled" hidden="true"/>
	</panel>
	
	<panel name="mainPanel2" title="Amount" sidebar="true">
		<field name="netAmmount" />
		<field name="netIGST" title="Net IGST" />
		<field name="netCSGT"  title="Net CSGT"/>
		<field name="netSGST" title="Net SGST"/>
		<field name="grossAmount" title="Gross Amount"/>
	</panel>
	
	<panel name="invoiceLinePanle" title="Invoice items">
		<panel-related field="invoiceItem" colSpan="12" onChange="action-set-invoice-net" />
	</panel>

	</form>
	
	<action-record name="action-on-new-date-time" model="com.axelor.gst.db.Invoice">
		<field name="invoiceDate" expr="eval: __date__"/>
	</action-record>
	
	<action-record name="action-click-validate" model="com.axelor.gst.db.Invoice">
		<field name="status" expr="eval: 2" />
	</action-record>
	<action-record name="action-click-paid" model="com.axelor.gst.db.Invoice">
		<field name="status" expr="eval: 3"  />
	</action-record>
		<action-record name="action-click-Cancelled" model="com.axelor.gst.db.Invoice">
		<field name="status" expr="eval: 4"  />
	</action-record>
	<action-record name="action-invoice-button-click-draft" model="com.axelor.gst.db.Invoice">
		<field name="status" expr="eval: 1" />
	</action-record>
	<action-attrs name="action-invoice-hide-button" model="com.axelor.gst.db.Invoice">
		<attribute name="hidden" for="paidBtn" expr="eval: status == '2' ? fasle : true"/>
		<attribute name="hidden" for="cancelledBtn" expr="eval: status == '2' ? false : true" />
		<attribute name="hidden" for="validateBtn" expr="eval: status == '2'|| status == '4' || staus == '3' ? true : false"/>
		<attribute name="hidden" for="draftBtn" expr="eval: status == '4' ? false : true" />
	</action-attrs>
	
	<action-record name="action-one-new-default-company" model="com.axelor.gst.db.Invoice">
 		<field name="company" expr="eval: __repo__(Company).all().fetchOne()" /> 
	</action-record>
	
	<action-method name="action-set-party-contact" model="com.axelor.gst.db.Invoice">
		<call class="com.axelor.gst.web.InvoiceController" method="setPartyContact"/>
	</action-method>
	
	<action-method name="action-invoiceAdd-as-shippingAdd" model="com.axelor.gst.db.Invoice">
		<call class="com.axelor.gst.web.InvoiceController" method="setShippingAdd"/>
	</action-method>
	
	
	<action-method name="action-set-invoice-net" model="com.axelor.gst.db.Invoice">
		<call class="com.axelor.gst.web.InvoiceController" method="setInvoiceNet"/>
	</action-method>
	
	<action-method name="action-set-invoice-refrence" model="com.axelor.gst.db.Invoice">
		<call class="com.axelor.gst.web.InvoiceController" method="setSequence" />
	</action-method>
	
	<action-report
		name="print-invoice" 
		output="IO-${name}-${date}-${time}" 
		design="Invoice.rptdesign">
		<param name="invoiceId" expr="eval: id"/>
	</action-report>
	
	<action-method name="action-set-product" model="com.axelor.gst.db.Invoice">
		<call class="com.axelor.gst.web.InvoiceController" method="setSelectedProduct"/>
	</action-method>
</object-views>













